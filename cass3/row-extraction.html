<html><head><title>scala-cass: Row Extraction</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Thurston Sandberg" /><meta name="description" content="Java Cassandra Driver Bindings for Friendlier Scala" /><meta name="og:image" content="/scala-cass/img/poster.png" /><meta name="og:title" content="scala-cass: Row Extraction" /><meta name="og:site_name" content="scala-cass" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="Java Cassandra Driver Bindings for Friendlier Scala" /><link rel="icon" type="image/png" href="/scala-cass/img/favicon.png" /><meta name="twitter:title" content="scala-cass: Row Extraction" /><meta name="twitter:image" content="img/poster.png" /><meta name="twitter:description" content="Java Cassandra Driver Bindings for Friendlier Scala" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/scala-cass/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/scala-cass/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/scala-cass/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/scala-cass/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/scala-cass/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/scala-cass/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/scala-cass/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/scala-cass/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/scala-cass/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/scala-cass/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/scala-cass/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/scala-cass/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/scala-cass/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/scala-cass/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/scala-cass/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/scala-cass/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/scala-cass/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/scala-cass/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/scala-cass/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/scala-cass/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/scala-cass/highlight/styles/docco.css" /><link rel="stylesheet" href="/scala-cass/css/style.css" /><link rel="stylesheet" href="/scala-cass/css/palette.css" /><link rel="stylesheet" href="/scala-cass/css/codemirror.css" /><link rel="stylesheet" href="/scala-cass/css/override.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/scala-cass/" class="brand"><div class="brand-wrapper"><span>scala-cass</span></div></a></li> <li><a href="/scala-cass/cassandra-30.html" class="">Cassandra 3.0+</a></li> <li><a href="/scala-cass/cass3/scalasession/getting-started.html" class="">ScalaSession</a> <ul class="sub_section"> <li><a href="/scala-cass/cass3/scalasession/getting-started.html" class="">Getting Started</a></li> <li><a href="/scala-cass/cass3/scalasession/create-table.html" class="">Creating a Table</a></li> <li><a href="/scala-cass/cass3/scalasession/insert.html" class="">Insert</a></li> <li><a href="/scala-cass/cass3/scalasession/update.html" class="">Update</a></li> <li><a href="/scala-cass/cass3/scalasession/delete.html" class="">Delete</a></li> <li><a href="/scala-cass/cass3/scalasession/select.html" class="">Select</a></li> <li><a href="/scala-cass/cass3/scalasession/batch.html" class="">Batch</a></li> <li><a href="/scala-cass/cass3/scalasession/raw.html" class="">Raw Statements</a></li> <li><a href="/scala-cass/cass3/scalasession/consistency-level.html" class="">Consistency Level</a></li></ul></li> <li><a href="/scala-cass/cass3/row-extraction.html" class=" active ">Row Extraction</a></li> <li><a href="/scala-cass/cass3/type-mappings.html" class="">Type Mappings</a></li> <li><a href="/scala-cass/cass3/date-codecs.html" class="">Date Codecs</a></li> <li><a href="/scala-cass/cass3/custom-encoders-decoders.html" class="">Custom Encoders/Decoders</a></li> <li><a href="/scala-cass/cass3/caching-implicits.html" class="">Caching Implicits</a></li>       </ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/thurstonsand/scala-cass"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/thurstonsand/scala-cass"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li></ul></div></div></div></div><div id="content" data-github-owner="thurstonsand" data-github-repo="scala-cass"><div class="content-wrapper"><section><h1 id="row-extraction">Row Extraction</h1>

<p>Cassandra’s <code class="highlighter-rouge">Row</code> holds the response from a statement. Using the driver, conversion into a useful Scala data type is 
cumbersome both in extracting a value from the Row, and converting it from the Java type. Scala-Cass handles all of that
transparently.</p>

<p>As an example, start with a <code class="highlighter-rouge">Row</code> retrieved from Cassandra table. Let’s say this table has a definition of</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">MyRow</span><span class="o">(</span><span class="n">s</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">i</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">l</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Long</span><span class="o">])</span> <span class="c1">// s varchar, i int, l bigint
</span><span class="n">defined</span> <span class="k">class</span> <span class="nc">MyRow</span>
</code></pre></div></div>
<p>Then we select a row using a <code class="highlighter-rouge">ScalaSession</code> (for more on <code class="highlighter-rouge">select</code>, <a href="/cass3/scalasession/select.html">see the relevant 
page</a>)</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Select</span><span class="o">(</span><span class="n">s</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>
<span class="n">defined</span> <span class="k">class</span> <span class="nc">Select</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">row</span><span class="k">:</span> <span class="kt">Row</span> <span class="o">=</span> <span class="n">sSession</span><span class="o">.</span><span class="n">selectOneStar</span><span class="o">(</span><span class="s">"mytable"</span><span class="o">,</span> <span class="nc">Select</span><span class="o">(</span><span class="s">"a str"</span><span class="o">)).</span><span class="n">execute</span><span class="o">().</span><span class="n">right</span><span class="o">.</span><span class="n">toOption</span><span class="o">.</span><span class="n">flatten</span><span class="o">.</span><span class="n">get</span>
<span class="n">row</span><span class="k">:</span> <span class="kt">com.datastax.driver.core.Row</span> <span class="o">=</span> <span class="nc">Row</span><span class="o">[</span><span class="kt">a</span> <span class="kt">str</span>, <span class="err">1234</span>, <span class="o">[</span><span class="err">5678</span><span class="o">]]</span>
</code></pre></div></div>

<p>First, let’s extract into <code class="highlighter-rouge">MyRow</code> using the regular driver</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">scala.collection.JavaConverters._</span>
<span class="k">import</span> <span class="nn">scala.collection.JavaConverters._</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">driverDerivedRow</span> <span class="k">=</span> <span class="nc">MyRow</span><span class="o">(</span><span class="n">row</span><span class="o">.</span><span class="n">getString</span><span class="o">(</span><span class="s">"s"</span><span class="o">),</span> <span class="n">row</span><span class="o">.</span><span class="n">getInt</span><span class="o">(</span><span class="s">"i"</span><span class="o">),</span> <span class="n">row</span><span class="o">.</span><span class="n">getList</span><span class="o">(</span><span class="s">"l"</span><span class="o">,</span> <span class="n">classOf</span><span class="o">[</span><span class="kt">java.lang.Long</span><span class="o">]).</span><span class="n">asScala</span><span class="o">.</span><span class="n">toList</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="nc">Long</span><span class="o">.</span><span class="n">unbox</span><span class="o">))</span>
<span class="n">driverDerivedRow</span><span class="k">:</span> <span class="kt">MyRow</span> <span class="o">=</span> <span class="nc">MyRow</span><span class="o">(</span><span class="n">a</span> <span class="n">str</span><span class="o">,</span><span class="mi">1234</span><span class="o">,</span><span class="nc">List</span><span class="o">(</span><span class="mi">5678</span><span class="o">))</span>
</code></pre></div></div>

<p>Especially for the <code class="highlighter-rouge">List[Long]</code>, it is unnecessarily verbose, since we already have the necessary type information. In
addition, we don’t know if any of these values came back as <code class="highlighter-rouge">null</code>, so in truth, we would need null checks as well</p>

<p>We can hide all of this boilerplate using the ScalaCass library. First, we need to import the syntax, 
<code class="highlighter-rouge">com.weather.scalacass.syntax</code>. Then let’s mirror that extraction from above</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">com.weather.scalacass.syntax._</span>
<span class="k">import</span> <span class="nn">com.weather.scalacass.syntax._</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">scalaCassDerivedRow</span> <span class="k">=</span> <span class="nc">MyRow</span><span class="o">(</span><span class="n">row</span><span class="o">.</span><span class="n">as</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="s">"s"</span><span class="o">),</span> <span class="n">row</span><span class="o">.</span><span class="n">as</span><span class="o">[</span><span class="kt">Int</span><span class="o">](</span><span class="s">"i"</span><span class="o">),</span> <span class="n">row</span><span class="o">.</span><span class="n">as</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">Long</span><span class="o">]](</span><span class="s">"l"</span><span class="o">))</span>
<span class="n">scalaCassDerivedRow</span><span class="k">:</span> <span class="kt">MyRow</span> <span class="o">=</span> <span class="nc">MyRow</span><span class="o">(</span><span class="n">a</span> <span class="n">str</span><span class="o">,</span><span class="mi">1234</span><span class="o">,</span><span class="nc">List</span><span class="o">(</span><span class="mi">5678</span><span class="o">))</span>
</code></pre></div></div>

<p>All we need to specify is the type that we 
want<a href="#type-mappings">*</a>, and the library handles the rest.
If one of these values came back null, the driver will throw an exception since we do not want to introduce null values
into our code.</p>

<p>If you do need to handle null types, use the <code class="highlighter-rouge">Option</code> type to extract values, as this will return <code class="highlighter-rouge">None</code> instead of 
null</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="n">row</span><span class="o">.</span><span class="n">as</span><span class="o">[</span><span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">]](</span><span class="s">"s"</span><span class="o">)</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="n">a</span> <span class="n">str</span><span class="o">)</span>
</code></pre></div></div>

<p>There are 2 convenience functions around this, <code class="highlighter-rouge">getAs</code> and <code class="highlighter-rouge">getOrElse</code>, that retrieves an Optional response of the type,
and, in the case of <code class="highlighter-rouge">getOrElse</code>, provides a default in the case it gets back a <code class="highlighter-rouge">None</code></p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="n">row</span><span class="o">.</span><span class="n">getAs</span><span class="o">[</span><span class="kt">Int</span><span class="o">](</span><span class="s">"i"</span><span class="o">)</span>
<span class="n">res5</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="mi">1234</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">row</span><span class="o">.</span><span class="n">getOrElse</span><span class="o">[</span><span class="kt">Int</span><span class="o">](</span><span class="s">"i"</span><span class="o">,</span> <span class="o">-</span><span class="mi">12345</span><span class="o">)</span>
<span class="n">res6</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">1234</span>
</code></pre></div></div>

<p>If you want to handle the exception yourself, there is a way to simply attempt the extraction and return either the 
success or the failure</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="n">row</span><span class="o">.</span><span class="n">attemptAs</span><span class="o">[</span><span class="kt">Int</span><span class="o">](</span><span class="s">"i"</span><span class="o">)</span>
<span class="n">res8</span><span class="k">:</span> <span class="kt">com.weather.scalacass.Result</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Right</span><span class="o">(</span><span class="mi">1234</span><span class="o">)</span>
</code></pre></div></div>

<h2 id="case-classes">Case Classes</h2>

<p>We already have a conveniently defined <code class="highlighter-rouge">MyRow</code> with all of the type information we want, so the Scala-Cass library (with
the help of the <a href="https://github.com/milessabin/shapeless">Shapeless library</a>) can automatically use the case class 
directly for extraction</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="n">row</span><span class="o">.</span><span class="n">as</span><span class="o">[</span><span class="kt">MyRow</span><span class="o">]</span>
<span class="n">res9</span><span class="k">:</span> <span class="kt">MyRow</span> <span class="o">=</span> <span class="nc">MyRow</span><span class="o">(</span><span class="n">a</span> <span class="n">str</span><span class="o">,</span><span class="mi">1234</span><span class="o">,</span><span class="nc">List</span><span class="o">(</span><span class="mi">5678</span><span class="o">))</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">row</span><span class="o">.</span><span class="n">getAs</span><span class="o">[</span><span class="kt">MyRow</span><span class="o">]</span>
<span class="n">res10</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">MyRow</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="nc">MyRow</span><span class="o">(</span><span class="n">a</span> <span class="n">str</span><span class="o">,</span><span class="mi">1234</span><span class="o">,</span><span class="nc">List</span><span class="o">(</span><span class="mi">5678</span><span class="o">)))</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">row</span><span class="o">.</span><span class="n">getOrElse</span><span class="o">[</span><span class="kt">MyRow</span><span class="o">](</span><span class="nc">MyRow</span><span class="o">(</span><span class="s">"default row"</span><span class="o">,</span> <span class="o">-</span><span class="mi">12345</span><span class="o">,</span> <span class="nc">List</span><span class="o">(-</span><span class="mi">5678L</span><span class="o">)))</span>
<span class="n">res11</span><span class="k">:</span> <span class="kt">MyRow</span> <span class="o">=</span> <span class="nc">MyRow</span><span class="o">(</span><span class="n">a</span> <span class="n">str</span><span class="o">,</span><span class="mi">1234</span><span class="o">,</span><span class="nc">List</span><span class="o">(</span><span class="mi">5678</span><span class="o">))</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">row</span><span class="o">.</span><span class="n">attemptAs</span><span class="o">[</span><span class="kt">MyRow</span><span class="o">]</span>
<span class="n">res12</span><span class="k">:</span> <span class="kt">com.weather.scalacass.Result</span><span class="o">[</span><span class="kt">MyRow</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Right</span><span class="o">(</span><span class="nc">MyRow</span><span class="o">(</span><span class="n">a</span> <span class="n">str</span><span class="o">,</span><span class="mi">1234</span><span class="o">,</span><span class="nc">List</span><span class="o">(</span><span class="mi">5678</span><span class="o">)))</span>
</code></pre></div></div>

<p>Note that no arguments (aside from the type parameter) are passed when extracting to a case class because you are acting
 on the entire row.</p>

<h5 id="for-performance-characteristics-of-these-extractions-see-the-performance-page">For performance characteristics of these extractions, <a href="/cass3/performance.html">see the performance page</a></h5>

<h5 id="for-a-full-list-of-type-mappings-between-the-cassandra-types-and-scala-types-see-the-type-mappings-page"><a name="type-mappings"></a>For a full list of type mappings between the Cassandra types and Scala types, <a href="/cass3/type-mappings.html">see the type mappings page</a></h5>

</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/scala-cass/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script>((window.gitter = {}).chat = {}).options = {
room: 'scala-cass/Lobby'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/scala-cass/js/main.js"></script></body></html>